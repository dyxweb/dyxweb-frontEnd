## 复合图层
- 浏览器渲染的图层一般分为两大类：普通图层以及复合图层。
- Chrome源码调试 -> More Tools -> Rendering -> Layer borders勾选后，黄色的就是复合图层信息。
### 多个复合图层互不影响
- 普通文档流可以理解为一个复合图层(称为默认复合层，里面不管添加多少元素，其实都是在同一个复合图层中)。
- absolute布局(fixed也一样)虽然可以脱离普通文档流，但它仍然属于默认复合层。
- 可以通过硬件加速的方式声明一个新的复合图层，它会单独分配资源(也会脱离普通文档流，这样一来不管这个复合图层中怎么变化，也不会影响默认复合层)。
- GPU中各个复合图层是单独绘制的，所以互不影响。
### 生成新的复合图层(硬件加速)
- 最常用的方式：translate3d、translateZ。
- opacity属性/过渡动画(需要动画执行的过程中才会创建复合图层，动画没有开始或结束后元素还会回到之前的状态)。
- will-change属性，一般配合opacity与translate使用(作用是提前告诉浏览器要变化，这样浏览器会开始做一些优化工作)。
- `<video><iframe><canvas><webgl>`等元素。
### absolute和生成新的复合图层(硬件加速)的区别
- absolute虽然可以脱离普通文档流，但是无法脱离默认复合层。所以就算absolute中信息改变时不会改变普通文档流中render树，但是浏览器最终绘制时是整个复合层绘制的，所以absolute中信息的改变，仍然会影响整个复合层的绘制。(浏览器会重绘它，如果复合层中内容多，absolute带来的绘制信息变化过大，资源消耗也是非常严重的)
- 生成新的复合图层(硬件加速)直接就是在另一个复合层了，所以它的信息改变不会影响默认复合层。
### 生成新的复合图层作用
- 元素开启硬件加速后会变成复合图层，可以独立于普通文档流中，改动后可以避免整个页面重绘，提升性能。
- 尽量不要大量使用复合图层，否则由于资源消耗过度，页面反而会变的更卡。
### 生成新的复合图层要使用index
- 使用硬件加速生成新的复合层时，尽可能的使用index，防止浏览器默认给后续的元素创建复合层渲染。
- 如果某个元素添加了硬件加速，并且index层级比较低，那么在这个元素的后面其它元素(层级比这个元素高的或者相同的，并且relative或absolute属性相同的)，会默认变为复合层渲染，如果处理不当会极大的影响性能。如果a是一个复合图层，而且b在a上面，那么b也会被隐式转为一个复合图层。
