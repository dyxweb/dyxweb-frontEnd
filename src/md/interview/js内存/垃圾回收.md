## 垃圾回收
> JavaScript在创建变量（对象，字符串等）时自动进行了内存分配，并且在不使用它们时“自动”释放，释放的过程称为垃圾回收。垃圾回收机制会定期（周期性）找出那些不再用到的内存（变量）然后释放其内存，JavaScript的运行环境极大地依赖于垃圾回收机制。

### 内存空间
> JavaScript的内存空间分为栈（Stack）和堆（Heap）两部分。栈用于存储原始类型（如Number，String，Boolean，Null，Undefined，Symbol）和引用对象的内存地址，而堆用于存储引用类型的对象。

### 栈回收
> 函数调用的参数、返回地址和局部变量都存储在调用栈中。每当一个函数被调用时，都会创建一个新的栈帧，其中包含这些信息。而栈帧的回收则非常直接：一旦函数调用结束，其栈帧就会被立即移除。这种机制依赖于ESP（Extended Stack Pointer）指针，该指针始终指向栈的顶部，用于追踪哪些栈帧是活动的，哪些可以被安全回收。

```
function getName() {
  let a = 1
  let b = {
    name: 'Hello World'
  }
  function foo() {
    let c = 2
    let d = {
      name: 'Hello Javascript'
    }
  }
  foo()
}
getName()
```
### 堆回收
> 与栈回收机制相比，堆回收要复杂得多。所有的对象实例都存储在堆中。这些对象的生命周期不像栈帧那样简单明了，因此需要更复杂的机制来确定何时可以安全回收这些对象的内存。主要采用标记清除算法进行垃圾回收。该算法分为两个步骤：标记阶段，V8引擎会遍历所有的对象，标记活动对象和非活动对象；清除阶段，非活动对象所占用的内存将被回收。

```
function createObject() {
  let obj = new Object();
  obj.value = 'Hello, World!';
  return obj;
}

let myObject = createObject();  // 创建对象，分配内存
myObject = null;  // 丢弃对象，垃圾回收器现在可以回收这个对象的内存
```
### 标记清除（常用的方法）
> 垃圾回收机制在运行的时候会给存储在内存中的所有变量都加上标记（可以是任何标记方式），然后它会去掉处在环境中的变量及被环境中的变量引用的变量的标记（闭包）。而在此之后剩下的带有标记的变量被视为准备删除的变量，原因是环境中的变量已经无法访问到这些变量了。最后垃圾回收机制到下一个周期运行时，将释放这些变量的内存，回收它们所占用的空间。

### 引用计数
> 语言引擎有一张"引用表"，保存了内存里面所有资源（通常是各种值）的引用次数。如果一个值的引用次数是0，就表示这个值不再用到了，因此可以将这块内存释放。循环使用会有内存无法释放的情况。