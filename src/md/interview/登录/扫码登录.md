## 扫码登录
![扫码登录](./img/%E6%89%AB%E7%A0%81%E7%99%BB%E5%BD%95.png)
- 待扫码阶段：
  1. PC端：打开某个网站或者某个APP的扫码登录入口，就会携带PC端的设备信息向服务端发送一个获取二维码的请求。
  2. 服务端：服务器收到请求后，随机生成一个UUID作为二维码ID，并将UUID与PC端的设备信息关联起来存储在Redis服务器中，然后返回给PC端，同时设置一个过期时间，在过期后用户登录二维码需要刷新重新获取。
  3. PC端：收到二维码ID之后，将二维码ID以二维码的形式展示，等待移动端扫码。并且此时的PC端开始轮询查询二维码状态，直到登录成功。如果移动端未扫码，那么一段时间后二维码会自动失效。
- 已扫码待确认阶段：
  1. 手机端：打开手机端对应已登录的APP扫描识别PC端展示的二维码，移动端扫描二维码后，会自动获取到二维码ID，并将移动端登录的信息凭证Token和二维码ID作为参数发送给服务端，此时手机必须是已登录（使用扫描登录的前提是移动端的应用为已登录状态，这样才可以共享登录态）。
  2. 服务端：收到手机端发来的请求后，会将Token与二维码ID关联，关联的作用是当我们在使用应用时，移动端退出后PC端也应该随之退出登录，这个关联就起到这个作用。然后会生成一个临时Token，这个Token会返回给移动端，一次性Token用作确认时的凭证。
- 已确认阶段：
  1. 手机端：收到确认信息后，点击确认按钮，移动端携带上一步中获取的临时Token发送给服务端校验。
  2. 服务端：服务端校验完成后，会更新二维码状态，并且给PC端生成一个正式的Token，后续PC端就是持有这个正式Token访问服务端。
  3. PC端：轮询到二维码状态为已登录状态，并且会获取到生成的正式Token，完成登录，后续访问都基于正式Token完成。
